<% provide(:title, "Home")%>
<% if logged_in? %>
  <div class="row">
    <aside class="col-md-4">
      <section class="user_info">
        <%= render 'shared/user_info' %>
      </section>
      <section class="micropost_form">
        <%= render 'shared/micropost_form' %>
      </section>
    </aside>
    <div class="col-md-8">
      <h3>Micropost Feed</h3>
      <%= render 'shared/feed'%>
    </div>
  </div>
<% else %>
<div class="center jumbotron">
  <h1>Welcome to Rails Fwitter</h1>

  <h2>
    This is the home page for the
    <a href="http://www.railstutorial.org/">Ruby on Rails Tutorial</a>
    sample application.
  </h2>

  <%= link_to "Sign up now!", signup_path, class: "btn btn-lg btn-primary" %>
  <%= link_to("login with facebook!", "/auth/facebook") %>
</div>
<% end %>



<script type="text/javascript" charset="utf-8">
  $(function(){
    $('form').submit(function(event){
      event.preventDefault();

      var values = $(this).serialize();

      var posting = $.post('/microposts', values);

      posting.done(function(data){

        var newPost = '<li id="micropost-'+data['micropost']['id']+'">';
        newPost += '<span class="user">'+data['micropost']['user']['name']+'</span>';
        newPost += '<span class="content">'+data['micropost']['content']+'</span>';
        newPost += '<span class="timestamp"> Posted at '+data['micropost']['created_at']+'</span>';
        newPost += '</li>'

        $('.microposts').prepend(newPost);
        console.log(data);
      });



    });
  });
</script>
